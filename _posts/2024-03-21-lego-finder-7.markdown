---
layout: post
title:  "Lego BrickFinder 만들기 - 7. 라즈베리파이 외부 배포"
date:   2024-03-21 16:00:00 +0900
categories: devlog daily
use_math: true
---

저번에 했던 라즈베리파이 배포를 이어서 하겠습니다. 이제 **공유기를 통해서라면** 다른 단말에서도 서버에 접속할 수 있게 되었습니다. 하지만 여전히 문제가 있는데, 집 안에서만 서버를 쓸 수가 있다는 겁니다. 반쪽짜리 서버를 제대로 서버 구실 하게 만들어주려면 **외부 IP**로 서버를 찾아올 수 있게 해주어야 합니다. 몇 동 몇 호에 사는지는 몰라도 아파트 단지의 주소를 알아야 택배를 관리실에 맡길 수는 있으니까요.  

## 포트포워딩

공유기에 연결된 단말에서 서버를 배포했습니다. 이걸 공유기를 통해 외부와 연결하기 위해선 포트를 열어야 합니다. 공유기에서 특정 포트를 열고, 그 포트로의 접근을 다른 주소로 바꿔주는 것을 **포트포워딩**이라 합니다. **외부 IP:포트 번호**로 접근하면 이를 모종의 규칙을 통해 **내부 IP: 다른 포트 번호**로 바꿔 연결합니다.

![portforwarding](/assets/images/2024-03-21-lego-finder-7/portforwarding.png)

물론 포트 번호는 같은 것을 쓸 수도 있습니다. 외부 5000번 - 내부 5000번 같이 해줄 수 있고 동작에는 아무런 문제가 없습니다. 다만 나중에 서버 확장을 하겠다고 라즈베리파이를 하나 더 연결해서 내부 IP 253:5000에도 포트를 열어줘야 한다면 이 때는 번호를 바꿔줘야 할 겁니다. 또한 22번(SSH), 80번(HTTP) 등 미리 할당된 또는 잘 알려진 포트 번호를 그대로 쓰는 것은 해킹 위험을 높이니 일부러 바꿔주기도 합니다. 그런데 이런 골방에서 배포하는 서버를 누가 해킹할까 싶긴 하네요.

외부 IP는 기본 설정 페이지 등에서 확인 가능합니다.

![address](/assets/images/2024-03-21-lego-finder-7/address.png)

공유기를 거치지 않고 외부에서 접속할 수 있게 되었습니다. 와이파이를 비활성화한 휴대전화로도 접속 됩니다.

![result](/assets/images/2024-03-21-lego-finder-7/result.jpg)
